# 新MCP追加チェックリスト（Proxy前提）

このチェックリストの目的は、
**MCPが増えてもコンテキストが圧迫されず、壊れず、安全に増やせる** 状態を保つことです。

> **重要**: Phase 4 以降、Claude Code が接続する MCP は `taisun-proxy` のみです。
> 新しい MCP を追加する場合は `.mcp.json` ではなく、**内部レジストリ**に登録してください。
> 詳細: [26_PROXY_SINGLE_ENTRYPOINT.md](./26_PROXY_SINGLE_ENTRYPOINT.md)

## A. 追加前の確認（本当に必要？）
- [ ] そのMCPは「既存のMCP/スキル」で代替できないか？
- [ ] 追加する理由が1文で説明できるか？（何が速くなる/何が正確になる）
- [ ] データの種類は？（公開情報 / 社内情報 / 個人情報 / 決済 等）
- [ ] 失敗時の被害は？（読むだけ / 書き換える / 消す / 公開する）

## B. "Claude側へ露出"の判断（原則：露出させない）
- [ ] Claude Code 側に新しいツール定義を増やす必要はあるか？
- [ ] 原則：Proxy内部で使う（skill.run内で呼ぶ）
- [ ] 例外：本当に汎用で、頻度が高く、リスクが低いものだけ

## C. Proxy側に追加するもの（推奨）
- [ ] "道具カード（短い説明）"を登録する
      例：名前 / できること / 入出力 / リスク / 代表例
- [ ] Routerルールを追加する（危ない操作は承認へ）
- [ ] タイムアウト/リトライ/レート制限の方針を決める
- [ ] 出力の整形方針（長文はメモリへ、会話には要約のみ）

## D. セキュリティ・秘密情報
- [ ] APIキー等は `.env` に入れ、リポジトリにコミットしない
- [ ] `.env.example` または `.env.tools.example` に "キー名だけ" 追記
- [ ] 権限は最小（read-onlyが可能ならread-only）

## E. テスト・動作確認
- [ ] 疎通確認（最小コマンドで1回動く）
- [ ] 失敗時のメッセージが分かりやすい（原因が追える）
- [ ] `npm test / lint / typecheck` が通る

## F. ログ・運用
- [ ] Issueを作って開始している（テンプレ使用）
- [ ] PRにIssue番号をリンクした
- [ ] マージ後、Issueに結果（動作確認・注意点）を追記した
